def fetch_data(symbol):
    url = f"https://api.binance.com/api/v3/klines?symbol={symbol}&interval=15m&limit=100"
    response = requests.get(url)
    
    if response.status_code != 200:
        raise ValueError(f"Failed to fetch data: {response.status_code}")

    data = response.json()
    
    if not data or len(data) < 20:  # RSI needs at least 14 points
        raise ValueError(f"Insufficient data returned for {symbol}")
    
    df = pd.DataFrame(data, columns=[
        "timestamp", "open", "high", "low", "close", "volume",
        "close_time", "quote_asset_volume", "number_of_trades",
        "taker_buy_base_volume", "taker_buy_quote_volume", "ignore"
    ])
    df["close"] = pd.to_numeric(df["close"])
    df["volume"] = pd.to_numeric(df["volume"])
    return df
